(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724],{53257:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>T});var s=t(37876),l=t(14232),n=t(68143),r=t(78242),i=t(77328),d=t.n(i),c=t(6960),o=t(52393),x=t(60140),m=t(87965),u=t(92973),h=t(22333),j=t(24354),f=t(10747),p=t(99550),g=t(8720),v=t(48220),y=t(31777),N=t(43487),b=t(8893),w=t(48647),A=t(53333),S=t(65201),_=t(95506),k=t(14e3),C=t(46011),M=t(19657),E=t(60433),D=t(65104);let I=e=>{let{children:a,onClick:t}=e;return(0,s.jsx)(c.$,{className:"h-8 min-w-24 rounded-sm font-semibold text-white bg-primary/80 hover:bg-primary/60",onClick:t,children:a})},F=()=>{let e=(0,y.wA)(),a=(0,y.d4)(e=>e.user.settings.quickAdd||[]);return(0,s.jsx)(n.S,{title:"Quick Add",contentClassName:"p-0",action:(0,s.jsxs)(c.$,{className:"has-[>svg]:px-2 py-1 h-auto rounded-sm text-xs text-primary bg-transparent hover:bg-primary/20",onClick:()=>{e((0,N.wF)(!0))},children:[(0,s.jsx)(D.A,{className:"size-3"})," Manage"]}),children:(null==a?void 0:a.length)>0?(0,s.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 place-items-center gap-2 pt-4 pb-1",children:null==a?void 0:a.map(a=>(0,s.jsx)(I,{onClick:()=>{e((0,N.cC)(a._id)),e((0,N.us)(!0))},children:a.name},a._id))}):null})};var R=t(28638);let K=e=>{let{bgColor:a,children:t,className:l,style:n}=e;return(0,s.jsxs)(R.Zp,{className:(0,w.cn)("py-4 justify-between relative overflow-hidden",l),style:{...n},children:[(0,s.jsx)(R.aR,{className:"px-4",children:(0,s.jsx)(R.ZB,{className:"font-normal text-sm text-muted-foreground",children:"This Month"})}),(0,s.jsx)(R.Wu,{className:"px-4",children:t}),a&&(0,s.jsx)("div",{className:"absolute bottom-0 left-0 h-full w-full",style:{backgroundImage:"linear-gradient(to right, transparent 10%, ".concat(a,"66 100%)")}})]})},O=e=>{let a=(0,o.f)(),{overview:t}=(0,y.d4)(e=>e.expenses),l=[...(null==t?void 0:t.categories)||[]].sort((e,a)=>a.amount-e.amount)[0];return(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[(null==t?void 0:t.summary)?(0,s.jsx)(K,{children:(0,s.jsxs)("div",{className:"grid grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Income"}),(0,s.jsxs)("p",{className:"font-bold text-emerald-500",children:[a," ",null==t?void 0:t.summary.monthlyIncome]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Total Spend"}),(0,s.jsxs)("p",{className:"font-bold text-rose-400",children:[a," ",null==t?void 0:t.summary.totalExpenses]})]})]})}):null,l?(0,s.jsx)(K,{bgColor:null==l?void 0:l.color,children:(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Most Spend On"}),(0,s.jsx)("p",{className:"font-bold",children:null==l?void 0:l.name})]})}):null]})})},P=Array.from({length:5},(e,a)=>{let t=new Date;return t.setMonth(t.getMonth()-a),{value:t.getMonth(),label:t.toLocaleString("default",{month:"short"}),year:t.getFullYear()}}),z=e=>{let{loading:a}=e,t=(0,y.wA)(),l=(0,y.d4)(e=>e.expenses.recentExpenses),n=()=>{b.F.expenses.getRecents({limit:5}).then(e=>{if(!e.error){var a;t((0,_.X9)((null==(a=e.data)?void 0:a.data)||[]))}})};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(C.A,{expenses:l,loading:a,onDelete:()=>{n()}})})},B=e=>{let{loading:a,selectedMonth:t,setSelectedMonth:l}=e,{totalAmount:r,barChartData:i,pieChartData:d,categoriesBarChartData:c}=(0,y.d4)(e=>e.expenses.dashboardAnalytics),N=(0,o.f)();return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"hidden sm:block",children:"Last 5 Month : "}),(0,s.jsx)(x.tU,{value:t.toString(),onValueChange:e=>l(Number(e)),children:(0,s.jsx)(x.j7,{children:P.map(e=>(0,s.jsx)(x.Xi,{value:e.value.toString(),children:e.label},e.value))})})]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"text-base font-thin mr-2",children:"Total : "}),(0,s.jsxs)("span",{className:"text-3xl",children:[(0,o.f)()," ",r]})]})]}),(0,s.jsx)("div",{className:"w-full my-4",children:(0,s.jsx)(n.S,{title:"Daily",className:"",children:(0,s.jsx)(v.at,{config:{amount:{label:"Amount"}},className:"pt-4 max-h-[250px] w-full",children:a?(0,s.jsx)(S.A,{type:"monthly"}):i.length?(0,s.jsxs)(m.E,{data:i,children:[(0,s.jsx)(v.II,{cursor:!1,content:(0,s.jsx)(v.Nt,{formatter:e=>(0,s.jsxs)("div",{className:"flex-1 flex items-center justify-between gap-2",children:[(0,s.jsx)("span",{className:"text-xs",children:"Amount"}),(0,s.jsxs)("span",{className:"text-xs",children:[N," ",e]})]})})}),(0,s.jsx)(u.y,{dataKey:"amount",maxBarSize:10,radius:[4,4,0,0],fill:"var(--chart-1)"}),(0,s.jsx)(h.W,{dataKey:"date",tickFormatter:e=>new Date(e).toLocaleDateString("en-US",{day:"numeric"})}),(0,s.jsx)(j.h,{})]}):(0,s.jsx)("div",{className:"h-full p-8 px-10",children:(0,s.jsx)("div",{className:"flex items-center justify-center h-full border-b border-l text-2xl text-muted-foreground",children:"No Data Available"})})})})}),(0,s.jsxs)("div",{className:"flex items-center justify-center flex-col lg:flex-row gap-4 mt-2",children:[(0,s.jsx)("div",{className:"flex-1 w-full",children:(0,s.jsx)(n.S,{title:"Spent On",className:"",children:(0,s.jsx)(v.at,{config:{amount:{label:"Amount"}},className:"pt-4",children:a?(0,s.jsx)(S.A,{type:"monthly"}):(null==c?void 0:c.length)?(0,s.jsxs)(m.E,{data:c,children:[(0,s.jsx)(v.II,{cursor:!1,content:(0,s.jsx)(v.Nt,{formatter:e=>(0,s.jsxs)("div",{className:"flex-1 flex items-center justify-between gap-2",children:[(0,s.jsx)("span",{className:"text-xs",children:"Amount"}),(0,s.jsxs)("span",{className:"text-xs",children:[N," ",e]})]})})}),(0,s.jsx)(u.y,{dataKey:"amount",maxBarSize:10,radius:[4,4,0,0],children:c.map((e,a)=>(0,s.jsx)(f.f,{fill:e.color},"cell-".concat(a)))}),(0,s.jsx)(h.W,{dataKey:"name"}),(0,s.jsx)(j.h,{})]}):(0,s.jsx)("div",{className:"h-full p-8 px-10",children:(0,s.jsx)("div",{className:"flex items-center justify-center h-full border-b border-l text-2xl text-muted-foreground",children:"No Data Available"})})})})}),(0,s.jsx)("div",{className:"flex-1 w-full",children:(0,s.jsx)(n.S,{title:"Mode of Payment",className:"",children:(0,s.jsx)(v.at,{config:{cash:{label:"Cash"},card:{label:"Card"},upi:{label:"UPI"},net_banking:{label:"Net Banking"},others:{label:"Others"}},children:a?(0,s.jsx)("div",{className:"h-full p-8 px-10",children:(0,s.jsx)("div",{className:"flex items-end justify-center gap-1 h-full px-2 text-2xl text-muted-foreground",children:(0,s.jsx)(A.E,{className:"h-full aspect-square rounded-full bg-blue-500/20"})})}):d.length?(0,s.jsxs)(p.r,{children:[(0,s.jsx)(v.II,{cursor:!1,content:(0,s.jsx)(v.Nt,{})}),(0,s.jsx)(g.F,{data:d,dataKey:"amount",innerRadius:"70%",outerRadius:"90%"}),(0,s.jsx)(v._3,{content:(0,s.jsx)(v.Hm,{nameKey:"name"}),className:"-translate-y-2 flex-wrap gap-2 *:basis-1/4 *:justify-center"})]}):(0,s.jsx)("div",{className:"h-full p-12 px-10",children:(0,s.jsx)("div",{className:"mx-auto flex items-center justify-center text-center h-full border rounded-full aspect-square text-2xl text-muted-foreground",children:"No Data Available"})})})})})]})]})},T=e=>{let a=new URLSearchParams,t=(0,k.useSearchParams)(),{replace:i}=(0,k.useRouter)(),o=(0,y.wA)(),[x,m]=(0,l.useState)(!0),[u,h]=(0,l.useState)(!0),[j,f]=(0,l.useState)(new Date().getMonth());(0,l.useEffect)(()=>{g(),p()},[]),(0,l.useEffect)(()=>{v()},[j]),(0,l.useEffect)(()=>{let e=parseInt(t.get("month")||""),s=parseInt(t.get("year")||"");if(e&&s){let t=P.find(a=>a.value===e-1&&a.year===s);t?f(t.value):(a.set("month","".concat(P[0].value+1)),a.set("year","".concat(P[0].year)),i("?".concat(a.toString())),f(P[0].value))}},[t]);let p=()=>{b.F.expenses.getMonthlyOverview().then(e=>{if(!e.error){var a;o((0,_.mK)((null==(a=e.data)?void 0:a.data)||[]))}})},g=()=>{b.F.expenses.getRecents({limit:5}).then(e=>{if(!e.error){var a;o((0,_.X9)((null==(a=e.data)?void 0:a.data)||[]))}}).finally(()=>{m(!1)})},v=()=>{let e=P.find(e=>e.value===j);if(e){let a=(0,w.Gg)(e.value,e.year);b.F.expenses.getMonthlyAnalytics({month:e.value+1,year:e.year}).then(e=>{if(!e.error){var t,s,l,n;let r={totalAmount:null==(t=e.data)?void 0:t.data.totalAmount,barChartData:(null==(s=e.data)?void 0:s.data.analytics.daily.length)?a.map(a=>{var t;let s=null==(t=e.data)?void 0:t.data.analytics.daily.find(e=>e.date===a.date);return{...a,amount:s?s.amount:0}}):[],pieChartData:null==(l=e.data)?void 0:l.data.analytics.paymentModes.map((e,a)=>({name:e.mode,amount:e.amount,fill:"var(--chart-".concat(a+1,")")})),categoriesBarChartData:null==(n=e.data)?void 0:n.data.analytics.categories.map(e=>({name:e.name,amount:e.amount,color:e.color}))};o((0,_.z)(r))}}).finally(()=>h(!1))}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d(),{children:(0,s.jsx)("title",{children:"Dashboard | Expense"})}),(0,s.jsxs)(r.A,{children:[(0,s.jsx)(M.A,{onAdd:()=>{g(),v(),p()}}),(0,s.jsx)(E.A,{onUpdate:()=>{g(),v(),p()}}),(0,s.jsx)("div",{className:"py-4",children:(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsx)(O,{}),(0,s.jsx)(F,{}),(0,s.jsx)(n.S,{title:"Monthly Overview",children:(0,s.jsx)(B,{loading:u,selectedMonth:j,setSelectedMonth:e=>{let t=P.find(a=>a.value===e)||P[0];a.set("month",(t.value+1).toString()),a.set("year",t.year.toString()),i("?".concat(a.toString())),f(e)}})}),(0,s.jsx)(n.S,{title:"Recent",action:(0,s.jsxs)(c.$,{className:"has-[>svg]:px-2 py-1 h-auto rounded-sm text-xs text-primary bg-transparent hover:bg-primary/20",onClick:()=>o((0,N.us)(!0)),children:[(0,s.jsx)(D.A,{className:"size-3"})," Add"]}),children:(0,s.jsx)(z,{loading:x})})]})})]})]})}},67580:(e,a,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return t(53257)}])}},e=>{var a=a=>e(e.s=a);e.O(0,[627,992,809,122,149,242,87,195,636,593,792],()=>a(67580)),_N_E=e.O()}]);