(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[51],{52704:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/spend-category",function(){return s(82294)}])},78651:(e,t,s)=>{"use strict";s.d(t,{S:()=>n});var a=s(37876);s(14232);var r=s(29470),c=s(84296),l=s(33276),i=s(48647);function n(e){let{className:t,...s}=e;return(0,a.jsx)(r.bL,{"data-slot":"checkbox",className:(0,i.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=indeterminate]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary dark:data-[state=indeterminate]:bg-primary data-[state=checked]:border-primary dark:data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:(0,a.jsxs)(r.C1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:["indeterminate"===s.checked&&(0,a.jsx)(c.A,{className:"size-3.5"}),!0===s.checked&&(0,a.jsx)(l.A,{className:"size-3.5"})]})})}},82294:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>$});var a=s(37876),r=s(77328),c=s.n(r),l=s(15060),i=s(31777),n=s(6960),o=s(12089),d=s(65104),u=s(7446),x=s(14232),m=s(19992),p=s(30822),g=s(48647);function h(e){let{...t}=e;return(0,a.jsx)(m.bL,{"data-slot":"accordion",...t})}function b(e){let{className:t,...s}=e;return(0,a.jsx)(m.q7,{"data-slot":"accordion-item",className:(0,g.cn)("border-b last:border-b-0",t),...s})}function v(e){let{className:t,children:s,...r}=e;return(0,a.jsx)(m.Y9,{className:"flex",children:(0,a.jsxs)(m.l9,{"data-slot":"accordion-trigger",className:(0,g.cn)("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",t),...r,children:[s,(0,a.jsx)(p.A,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function y(e){let{className:t,children:s,...r}=e;return(0,a.jsx)(m.UC,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...r,children:(0,a.jsx)("div",{className:(0,g.cn)("pt-0 pb-4",t),children:s})})}var f=s(77932),j=s(78651),N=s(8893),k=s(57030),C=s(59688);let S=e=>{let{color:t,className:s,onChange:r,debounceTime:c=1e3}=e,[l,i]=(0,x.useState)("#f0f0f0"),n=(0,x.useRef)(null);(0,x.useEffect)(()=>()=>{n.current&&clearTimeout(n.current)},[]),(0,x.useEffect)(()=>{i(t||"#ff0000")},[t]);let o=(0,x.useCallback)(e=>(i(e),n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{r&&r(e)},c),()=>{n.current&&clearTimeout(n.current)}),[r,c]);return(0,a.jsx)("button",{type:"button",className:(0,g.cn)("aspect-square rounded-full border relative overflow-hidden h-4 cursor-pointer",s),style:{backgroundColor:l},"aria-label":"Choose color",children:(0,a.jsx)(f.p,{type:"color",className:"w-full h-full p-0 border-0 rounded-full opacity-0 cursor-pointer",value:l,onChange:e=>o(e.target.value),"aria-label":"Color picker"})})},w=e=>{var t;let{isSelected:s,isDeleting:r,category:c,onSelectChange:l}=e,m=(0,i.wA)(),[p,g]=(0,x.useState)(!1),[h,f]=(0,x.useState)(!1),[w,_]=(0,x.useState)([]),$=e=>{_(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return(0,a.jsxs)(b,{value:c._id,className:"border last:border-b rounded-lg bg-card relative",children:[(0,a.jsx)(v,{className:"hover:no-underline py-2 px-4",children:(0,a.jsx)("div",{className:"flex-1 flex items-center justify-between gap-2",children:(0,a.jsxs)("div",{className:"flex-1 text-sm font-medium flex items-center gap-2",children:[(0,a.jsx)(j.S,{checked:s,onCheckedChange:()=>{null==l||l(c._id)},onClick:e=>e.stopPropagation(),disabled:r}),(0,a.jsx)(z,{value:c.category_name,onEdit:e=>(N.F.categories.updateCategory(c._id,{name:e}).then(t=>!!t.data&&(m((0,k.st)({...c,category_name:e})),!0)).catch(e=>(console.log(e),!1)),!0)})]})})}),(0,a.jsx)(y,{children:(0,a.jsxs)("div",{className:"px-8 py-2 space-y-2 border-t",children:[(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[w.length>0?(0,a.jsx)(n.$,{type:"button",variant:"outline",className:"has-[>svg]:px-0 aspect-square py-0 h-6 rounded-sm text-xs text-destructive border-destructive/50 dark:border-destructive/50 bg-transparent shadow-none hover:text-destructive hover:bg-destructive/20 dark:hover:bg-destructive/40",onClick:()=>{f(!0),N.F.categories.deleteSubcategory(w).then(e=>{e.error||(m((0,k.jl)(w)),_([]),C.oR.success("Spend Type deleted successfully",{duration:4e3,position:"top-center",classNames:{success:"!bg-green-600"}}))}).finally(()=>{f(!1)})},children:(0,a.jsx)(o.A,{className:"size-4"})}):null,(0,a.jsxs)(n.$,{type:"button",className:"has-[>svg]:px-2 py-1 h-auto rounded-sm text-xs text-primary bg-transparent shadow-none hover:bg-primary/20",onClick:()=>g(!p),children:[(0,a.jsx)(d.A,{className:"size-3"})," Add"]})]}),p&&(0,a.jsx)(A,{sub_categories:c.subcategories||[],category_id:c._id,onCancel:()=>g(!1)}),(0,a.jsx)("ul",{className:"space-y-1",children:null==(t=c.subcategories)?void 0:t.map(e=>(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[(0,a.jsx)(j.S,{checked:w.includes(e._id),onCheckedChange:()=>{$(e._id)},onClick:e=>e.stopPropagation(),disabled:h})," ",(0,a.jsxs)("div",{className:"flex-1 flex items-center ml-2",children:[(0,a.jsx)(S,{color:e.color,onChange:t=>{N.F.categories.updateSubcategory(e._id,{color:t}).then(s=>{console.log(t),s.error||(m((0,k.YS)({cat_id:c._id,sub_cat:{...e,color:t}})),C.oR.success("Color updated successfully",{duration:4e3,position:"top-center",classNames:{success:"!text-green-600"}}))}).catch(e=>{console.log(e)})}}),(0,a.jsx)(z,{value:e.name,onEdit:t=>""===t.trim()||t===e.name||(N.F.categories.updateSubcategory(e._id,{name:t}).then(s=>!s.error&&(m((0,k.YS)({cat_id:c._id,sub_cat:{...e,name:t}})),!0)).catch(e=>(console.log(e),!1)),!1)})]})]},e._id))})]})}),r?(0,a.jsx)("div",{className:"absolute top-0 left-0 w-full h-full rounded-lg bg-black/5 dark:bg-black/50 z-10 flex items-center justify-center",children:(0,a.jsx)(u.A,{className:"size-8 text-destructive animate-spin"})}):null]},c._id)},_=e=>{let{onCancel:t}=e,s=(0,i.wA)(),[r,c]=(0,x.useState)(""),[l,m]=(0,x.useState)([""]),[p,h]=(0,x.useState)({category:!1,subcategories:[!1]}),[b,v]=(0,x.useState)(!1),y=l.every(e=>""!==e.trim()),j=""!==r.trim()&&y,S=p.category&&""===r.trim(),w=e=>p.subcategories[e]&&""===l[e].trim(),_=(e,t)=>{let s=[...l];if(s[e]=t,m(s),!p.subcategories[e]){let t=[...p.subcategories];t[e]=!0,h(e=>({...e,subcategories:t}))}},A=e=>{if(l.length>1){let t=l.filter((t,s)=>s!==e),s=p.subcategories.filter((t,s)=>s!==e);m(t),h(e=>({...e,subcategories:s}))}},z=async e=>{if(e.preventDefault(),j){let e={name:r.trim(),color:(0,g.gx)(),subcategories:l.map(e=>({name:e.trim(),color:(0,g.gx)()}))};v(!0),h({category:!1,subcategories:[!1]}),N.F.categories.createCategory(e).then(e=>{if(!e.error){var a;s((0,k.Ah)(null==(a=e.data)?void 0:a.data)),$(),null==t||t(),C.oR.success("Category created successfully",{duration:4e3,position:"top-center",classNames:{success:"!bg-green-600"}})}}).finally(()=>{v(!1)})}else h({category:!0,subcategories:l.map(()=>!0)})},$=()=>{c(""),m([""]),h({category:!1,subcategories:[!1]})};return(0,a.jsxs)("form",{onSubmit:z,className:"mt-4 p-4 border rounded-lg bg-muted/10 relative",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)(f.p,{type:"text",placeholder:"Category name",value:r,onChange:e=>{c(e.target.value),h(e=>({...e,category:!0}))},onBlur:e=>{""===e.target.value.trim()?h(e=>({...e,category:!0})):h(e=>({...e,category:!1}))},className:"h-9 ".concat(S?"border-destructive":""),required:!0,maxLength:30,autoFocus:!0}),S&&(0,a.jsx)("p",{className:"text-xs text-destructive mt-1",children:"Category name is required"})]})}),(0,a.jsxs)("div",{className:"space-y-2 px-4 py-2",children:[(0,a.jsx)("label",{className:"block text-xs font-medium ",children:"Spend Type"}),l.map((e,t)=>(0,a.jsx)("div",{className:"flex gap-2 items-center",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(f.p,{type:"text",placeholder:"Spend Type ".concat(t+1),value:e,onChange:e=>_(t,e.target.value),className:"h-8 !text-xs ".concat(w(t)?"border-destructive":""),onBlur:e=>{let s=[...p.subcategories];""===e.target.value.trim()?s[t]=!0:s[t]=!1,h(e=>({...e,subcategories:s}))},autoFocus:l.length>1}),l.length>1&&(0,a.jsx)(n.$,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>A(t),children:(0,a.jsx)(o.A,{className:"h-4 w-4"})})]}),w(t)&&(0,a.jsx)("p",{className:"text-xs text-destructive mt-2 px-1",children:"Spend type is required"})]})},t)),(0,a.jsxs)(n.$,{type:"button",size:"sm",className:"has-[>svg]:px-2 mt-1 py-1 h-auto rounded-sm text-xs text-primary bg-transparent shadow-none hover:bg-primary/20",onClick:()=>{m([...l,""]),h(e=>({...e,subcategories:[...e.subcategories,!1]}))},children:[(0,a.jsx)(d.A,{className:"h-3 w-3"})," Add More"]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(n.$,{type:"button",variant:"outline",size:"sm",className:"text-xs",onClick:()=>{null==t||t(),$()},children:"Cancel"}),(0,a.jsx)(n.$,{type:"submit",size:"sm",disabled:!j,className:"text-xs ".concat(j?"":"opacity-70 cursor-not-allowed"),children:"Save"})]})]}),b&&(0,a.jsx)("div",{className:"absolute top-0 left-0 w-full h-full rounded-lg bg-black/5 dark:bg-black/50 z-10 flex items-center justify-center",children:(0,a.jsx)(u.A,{className:"size-8 text-primary animate-spin"})})]})},A=e=>{let{sub_categories:t,category_id:s,onCancel:r}=e,c=(0,i.wA)(),[l,m]=(0,x.useState)([""]),[p,h]=(0,x.useState)([]),[b,v]=(0,x.useState)(!1),y=l.every(e=>""!==e.trim()),j=e=>p[e]&&""===l[e].trim(),S=(e,t)=>{let s=[...l];if(s[e]=t,m(s),!p[e]){let t=[...p];t[e]=!0,h(e=>t)}},w=e=>{if(l.length>1){let t=l.filter((t,s)=>s!==e),s=p.filter((t,s)=>s!==e);m(t),h(s)}},_=()=>{m([""]),h([!1])};return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),v(!0),N.F.categories.createSubcategory({category_id:s,subcategories:l.map(e=>({name:e,color:(0,g.gx)()}))}).then(e=>{if(!e.error){var a;c((0,k.W$)({cat_id:s,sub_cat:[...t,...null==(a=e.data)?void 0:a.data.created]})),null==r||r(),_(),C.oR.success("Spend Type created successfully",{duration:4e3,position:"top-center",classNames:{success:"!bg-green-600"}})}}).finally(()=>{v(!1)})},className:"p-4 border rounded-lg bg-muted/10 relative",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[l.map((e,t)=>(0,a.jsx)("div",{className:"flex gap-2 items-center",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(f.p,{type:"text",placeholder:"Spend ".concat(t+1),value:e,onChange:e=>S(t,e.target.value),className:"h-8 !text-xs ".concat(j(t)?"border-destructive":""),onBlur:e=>{let s=[...p];""===e.target.value.trim()?s[t]=!0:s[t]=!1,h(e=>s)},autoFocus:!0}),l.length>1&&(0,a.jsx)(n.$,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>w(t),children:(0,a.jsx)(o.A,{className:"h-4 w-4"})})]}),j(t)&&(0,a.jsx)("p",{className:"text-xs text-destructive mt-2 px-1",children:"Spend type is required"})]})},t)),(0,a.jsxs)(n.$,{type:"button",size:"sm",className:"has-[>svg]:px-2 mt-1 py-1 h-auto rounded-sm text-xs text-primary bg-transparent hover:bg-primary/20",onClick:()=>{m([...l,""]),h(e=>[...e,!1])},children:[(0,a.jsx)(d.A,{className:"h-3 w-3"})," Add More"]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(n.$,{type:"button",variant:"outline",size:"sm",className:"text-xs",onClick:()=>{null==r||r(),_()},children:"Cancel"}),(0,a.jsx)(n.$,{type:"submit",size:"sm",disabled:!y,className:"text-xs ".concat(y?"":"opacity-70 cursor-not-allowed"),children:"Save"})]})]}),b&&(0,a.jsx)("div",{className:"absolute top-0 left-0 w-full h-full rounded-lg bg-black/5 dark:bg-black/50 z-10 flex items-center justify-center",children:(0,a.jsx)(u.A,{className:"size-8 text-primary animate-spin"})})]})},z=e=>{let{value:t,onEdit:s}=e,[r,c]=(0,x.useState)(!1),[l,i]=(0,x.useState)(!1),[n,o]=(0,x.useState)(t);(0,x.useEffect)(()=>{o(t)},[t]);let d=async()=>{i(!0),await s(n)&&c(!1),i(!1)};return r?(0,a.jsx)(f.p,{className:"px-2 py-1 h-auto border-0 !ring-0 bg-input/20 !shadow-none w-full",value:n,onChange:e=>o(e.target.value),onClick:e=>{e.stopPropagation()},autoFocus:!0,onBlur:d,disabled:l,maxLength:30}):(0,a.jsx)("p",{onClick:e=>{e.stopPropagation(),c(!0)},className:"cursor-text py-1 px-2 truncate",children:t})},$=e=>{let t=(0,i.wA)(),s=(0,i.d4)(e=>e.categories.categories),[r,u]=(0,x.useState)(!1),[m,p]=(0,x.useState)(s.map(e=>e._id)),[g,b]=(0,x.useState)([]),[v,y]=(0,x.useState)(!1);(0,x.useEffect)(()=>{p(s.map(e=>e._id))},[s]);let f=e=>{b(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c(),{children:(0,a.jsx)("title",{children:"Spend Category | Expense"})}),(0,a.jsx)(l.A,{children:(0,a.jsxs)("div",{className:"py-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Manage your Spend Category"}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm",children:"Add or remove your categories."}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[g.length>0?(0,a.jsx)(n.$,{type:"button",variant:"outline",className:"has-[>svg]:px-0 aspect-square py-0 h-6 rounded-sm text-xs text-destructive border-destructive/50 dark:border-destructive/50 bg-transparent shadow-none hover:text-destructive hover:bg-destructive/20 dark:hover:bg-destructive/40",onClick:()=>{y(!0),N.F.categories.deleteCategory(g).then(e=>{e.error||(b([]),t((0,k.zd)(g)),C.oR.success("Category deleted successfully",{duration:4e3,position:"top-center",classNames:{success:"!bg-green-600"}}))}).finally(()=>{y(!1)})},children:(0,a.jsx)(o.A,{className:"size-4"})}):null,(0,a.jsxs)(n.$,{type:"button",className:"has-[>svg]:px-2 py-1 h-auto rounded-sm text-xs text-primary bg-transparent shadow-none hover:bg-primary/20",onClick:()=>u(!r),children:[(0,a.jsx)(d.A,{className:"size-3"})," Add Category"]})]}),r&&(0,a.jsx)(_,{onCancel:()=>u(!1)}),(0,a.jsx)("div",{className:"flex flex-col mt-4 gap-4",children:(0,a.jsx)(h,{type:"multiple",className:"space-y-4",value:m,onValueChange:p,children:s.map(e=>(0,a.jsx)(w,{category:e,isSelected:g.includes(e._id),isDeleting:v&&g.includes(e._id),onSelectChange:f}))})})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[627,992,809,300,60,636,593,792],()=>t(52704)),_N_E=e.O()}]);