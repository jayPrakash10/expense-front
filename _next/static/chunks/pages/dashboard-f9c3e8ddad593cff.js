(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724],{753:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>U});var t=s(37876),l=s(14232),n=s(68143),r=s(60138),i=s(77328),c=s.n(i),d=s(6960),o=s(52393),x=s(60140),u=s(87965),m=s(92973),h=s(22333),f=s(24354),p=s(99550),j=s(8720),g=s(48220),y=s(31777),v=s(43487),N=s(8893),b=s(48647),w=s(53333),S=s(65201),C=s(95506),A=s(14e3),_=s(39834),k=s(19657),E=s(60433),D=s(65104);let M=Array.from({length:5},(e,a)=>{let s=new Date;return s.setMonth(s.getMonth()-a),{value:s.getMonth(),label:s.toLocaleString("default",{month:"short"}),year:s.getFullYear()}}),F=()=>{let e=(0,y.wA)();return(0,t.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 place-items-center gap-2 py-2",children:[(0,t.jsx)(d.$,{className:"h-8 min-w-24 rounded-sm font-semibold text-white bg-primary/80 hover:bg-primary/60",onClick:()=>{e((0,v.cC)("684ff4293a99c05454544f24")),e((0,v.us)(!0))},children:"Vegetable / Fruit"}),(0,t.jsx)(d.$,{className:"h-8 min-w-24 rounded-sm font-semibold text-white bg-primary/80 hover:bg-primary/60",onClick:()=>{e((0,v.cC)("684ff4373a99c05454544f28")),e((0,v.us)(!0))},children:"Groceries"}),(0,t.jsx)(d.$,{className:"h-8 min-w-24 rounded-sm font-semibold text-white bg-primary/80 hover:bg-primary/60",onClick:()=>{e((0,v.cC)("684ff3783a99c05454544f07")),e((0,v.us)(!0))},children:"Clothes"}),(0,t.jsx)(d.$,{className:"h-8 min-w-24 rounded-sm font-semibold text-white bg-primary/80 hover:bg-primary/60",onClick:()=>{e((0,v.cC)("684ff98d3a99c05454544f91")),e((0,v.us)(!0))},children:"Taxi / Cabs"})]})},I=e=>{let{loading:a}=e,s=(0,y.wA)(),l=(0,y.d4)(e=>e.expenses.recentExpenses),n=()=>{N.F.expenses.getRecents({limit:5}).then(e=>{if(!e.error){var a;s((0,C.X9)((null==(a=e.data)?void 0:a.data)||[]))}})};return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(_.A,{expenses:l,loading:a,onDelete:()=>{n()}})})},R=e=>{let{loading:a,selectedMonth:s,setSelectedMonth:l}=e,{totalAmount:r,barChartData:i,pieChartData:c}=(0,y.d4)(e=>e.expenses.dashboardAnalytics),d=(0,o.f)();return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"hidden sm:block",children:"Last 5 Month : "}),(0,t.jsx)(x.tU,{value:s.toString(),onValueChange:e=>l(Number(e)),children:(0,t.jsx)(x.j7,{children:M.map(e=>(0,t.jsx)(x.Xi,{value:e.value.toString(),children:e.label},e.value))})})]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"text-base font-thin mr-2",children:"Total : "}),(0,t.jsxs)("span",{className:"text-3xl",children:[(0,o.f)()," ",r]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-center flex-col lg:flex-row gap-4 mt-2",children:[(0,t.jsx)("div",{className:"flex-1 w-full",children:(0,t.jsx)(n.S,{title:"Daily",className:"",children:(0,t.jsx)(g.at,{config:{amount:{label:"Amount"}},className:"pt-4",children:a?(0,t.jsx)(S.A,{type:"monthly"}):i.length?(0,t.jsxs)(u.E,{data:i,children:[(0,t.jsx)(g.II,{cursor:!1,content:(0,t.jsx)(g.Nt,{formatter:e=>(0,t.jsxs)("div",{className:"flex-1 flex items-center justify-between gap-2",children:[(0,t.jsx)("span",{className:"text-xs",children:"Amount"}),(0,t.jsxs)("span",{className:"text-xs",children:[d," ",e]})]})})}),(0,t.jsx)(m.y,{dataKey:"amount",maxBarSize:20,radius:[4,4,0,0],fill:"var(--chart-1)"}),(0,t.jsx)(h.W,{dataKey:"date",tickFormatter:e=>new Date(e).toLocaleDateString("en-US",{day:"numeric"})}),(0,t.jsx)(f.h,{})]}):(0,t.jsx)("div",{className:"h-full p-8 px-10",children:(0,t.jsx)("div",{className:"flex items-center justify-center h-full border-b border-l text-2xl text-muted-foreground",children:"No Data Available"})})})})}),(0,t.jsx)("div",{className:"flex-1 w-full",children:(0,t.jsx)(n.S,{title:"Mode of Payment",className:"",children:(0,t.jsx)(g.at,{config:{cash:{label:"Cash"},card:{label:"Card"},upi:{label:"UPI"},net_banking:{label:"Net Banking"},others:{label:"Others"}},children:a?(0,t.jsx)("div",{className:"h-full p-8 px-10",children:(0,t.jsx)("div",{className:"flex items-end justify-center gap-1 h-full px-2 text-2xl text-muted-foreground",children:(0,t.jsx)(w.E,{className:"h-full aspect-square rounded-full bg-blue-500/20"})})}):c.length?(0,t.jsxs)(p.r,{children:[(0,t.jsx)(g.II,{cursor:!1,content:(0,t.jsx)(g.Nt,{})}),(0,t.jsx)(j.F,{data:c,dataKey:"amount",innerRadius:"70%",outerRadius:"90%"}),(0,t.jsx)(g._3,{content:(0,t.jsx)(g.Hm,{nameKey:"name"}),className:"-translate-y-2 flex-wrap gap-2 *:basis-1/4 *:justify-center"})]}):(0,t.jsx)("div",{className:"h-full p-12 px-10",children:(0,t.jsx)("div",{className:"mx-auto flex items-center justify-center text-center h-full border rounded-full aspect-square text-2xl text-muted-foreground",children:"No Data Available"})})})})})]})]})},U=e=>{let a=new URLSearchParams,s=(0,A.useSearchParams)(),{replace:i}=(0,A.useRouter)(),o=(0,y.wA)(),[x,u]=(0,l.useState)(!0),[m,h]=(0,l.useState)(!0),[f,p]=(0,l.useState)(new Date().getMonth());(0,l.useEffect)(()=>{j()},[]),(0,l.useEffect)(()=>{g()},[f]),(0,l.useEffect)(()=>{let e=parseInt(s.get("month")||""),t=parseInt(s.get("year")||"");if(e&&t){let s=M.find(a=>a.value===e-1&&a.year===t);s?p(s.value):(a.set("month","".concat(M[0].value+1)),a.set("year","".concat(M[0].year)),i("?".concat(a.toString())),p(M[0].value))}},[s]);let j=()=>{N.F.expenses.getRecents({limit:5}).then(e=>{if(!e.error){var a;o((0,C.X9)((null==(a=e.data)?void 0:a.data)||[]))}}).finally(()=>{u(!1)})},g=()=>{let e=M.find(e=>e.value===f);if(e){let a=(0,b.Gg)(e.value,e.year);N.F.expenses.getMonthlyAnalytics({month:e.value+1,year:e.year}).then(e=>{if(!e.error){var s,t,l;let n={totalAmount:null==(s=e.data)?void 0:s.data.totalAmount,barChartData:(null==(t=e.data)?void 0:t.data.analytics.daily.length)?a.map(a=>{var s;let t=null==(s=e.data)?void 0:s.data.analytics.daily.find(e=>e.date===a.date);return{...a,amount:t?t.amount:0}}):[],pieChartData:null==(l=e.data)?void 0:l.data.analytics.paymentModes.map((e,a)=>({name:e.mode,amount:e.amount,fill:"var(--chart-".concat(a+1,")")}))};o((0,C.z)(n))}}).finally(()=>h(!1))}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c(),{children:(0,t.jsx)("title",{children:"Dashboard | Expense"})}),(0,t.jsxs)(r.A,{children:[(0,t.jsx)(k.A,{onAdd:()=>{j(),g()}}),(0,t.jsx)(E.A,{onUpdate:()=>{j(),g()}}),(0,t.jsx)("div",{className:"py-4",children:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsx)(n.S,{title:"Quick Add",children:(0,t.jsx)(F,{})}),(0,t.jsx)(n.S,{title:"Recent",action:(0,t.jsxs)(d.$,{className:"h-8 w-24 rounded-sm font-semibold text-white bg-primary/80 hover:bg-primary/60",onClick:()=>o((0,v.us)(!0)),children:[(0,t.jsx)(D.A,{})," Add"]}),children:(0,t.jsx)(I,{loading:x})}),(0,t.jsx)(n.S,{title:"Monthly Overview",children:(0,t.jsx)(R,{loading:m,selectedMonth:f,setSelectedMonth:e=>{let s=M.find(a=>a.value===e)||M[0];a.set("month",(s.value+1).toString()),a.set("year",s.year.toString()),i("?".concat(a.toString())),p(e)}})})]})})]})]})}},60433:(e,a,s)=>{"use strict";s.d(a,{A:()=>v});var t=s(37876),l=s(13816),n=s(6960),r=s(77932),i=s(14232),c=s(9537),d=s(9299),o=s(52393),x=s(29898),u=s(28638),m=s(31777),h=s(8893),f=s(43487),p=s(27122),j=s(59688);let g=e=>{let{selected:a,onSelect:s}=e,l=(0,m.d4)(e=>e.categories.categories),[r,o]=(0,i.useState)(null);(0,i.useEffect)(()=>{o(l.flatMap(e=>e.subcategories).find(e=>(null==e?void 0:e._id)===a))},[a,l]);let x=e=>{o(e),s(e._id)};return(0,t.jsxs)(c.rI,{children:[(0,t.jsx)(c.ty,{asChild:!0,children:(0,t.jsx)(n.$,{variant:"outline",className:"w-full justify-start px-2",children:r?(0,t.jsx)("span",{className:"font-semibold",children:r.name}):(0,t.jsx)("span",{className:"text-muted-foreground",children:"Where did you spent?"})})}),(0,t.jsx)(c.SQ,{side:"bottom",align:"start",className:"lg:max-w-[600px]",children:(0,t.jsxs)(d.F,{className:"w-full whitespace-nowrap",children:[(0,t.jsx)("div",{className:"flex flex-col flex-wrap max-h-80 w-max gap-2 pb-3",children:l.map(e=>{var a;return(0,t.jsxs)(c.I,{className:"w-44",children:[(0,t.jsx)(c.lp,{className:"font-semibold",children:e.category_name}),(0,t.jsx)(c.mB,{className:"mx-0"}),null==(a=e.subcategories)?void 0:a.map(e=>(0,t.jsx)(c._2,{className:"text-muted-foreground",onSelect:()=>x(e),children:e.name},e._id))]},e._id)})}),(0,t.jsx)(d.$,{orientation:"horizontal"})]})})]})},y=e=>{let{selected:a,onSelect:s}=e,[l,r]=(0,i.useState)(null);(0,i.useEffect)(()=>{r(p.Q.find(e=>e.value===a))},[a,p.Q]);let d=e=>{r(e),s(null==e?void 0:e.value)};return(0,t.jsxs)(c.rI,{children:[(0,t.jsx)(c.ty,{asChild:!0,children:(0,t.jsx)(n.$,{variant:"outline",className:"w-full justify-start px-2",children:l?(0,t.jsx)("span",{className:"font-semibold",children:null==l?void 0:l.label}):(0,t.jsx)("span",{className:"text-muted-foreground",children:"How did you spent?"})})}),(0,t.jsx)(c.SQ,{side:"bottom",align:"start",className:"w-96",children:p.Q.map(e=>(0,t.jsx)(c._2,{onSelect:()=>d(e),children:e.label},e.value))})]})},v=e=>{let{onUpdate:a}=e,s=(0,m.wA)(),{expenseId:i,category:c,mode:d,amount:p,date:v,isUpdateExpenseOpen:N}=(0,m.d4)(e=>e.global),b=async()=>{try{let e={subcategory_id:c,mode_of_payment:d,amount:parseFloat(p),date:(null==v?void 0:v.toISOString())||new Date().toISOString()},t=await h.F.expenses.update(i,e);t.error?console.error("Error updating expense:",t.error):(j.oR.success("Expense updated successfully",{duration:4e3,position:"top-center",classNames:{success:"!text-green-600"}}),null==a||a(),s((0,f.rW)()),s((0,f.UB)(!1)))}catch(e){console.error("Error updating expense:",e)}},w=e=>{s((0,f.SR)(e))};return(0,t.jsx)(l.lG,{open:N,onOpenChange:e=>{s((0,f.UB)(e)),e||s((0,f.rW)())},children:(0,t.jsxs)(l.Cf,{className:"sm:max-w-4xl w-full",children:[(0,t.jsxs)(l.c7,{children:[(0,t.jsx)(l.L3,{children:"Update Expense"}),(0,t.jsx)(l.rr,{children:"Update your expense."})]}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-2 py-6",children:[(0,t.jsxs)("div",{className:"flex-1 flex flex-col gap-4",children:[(0,t.jsx)(g,{selected:c||"",onSelect:e=>{s((0,f.cC)(e))}}),(0,t.jsx)(y,{selected:d,onSelect:e=>{s((0,f.pe)(e))}}),(0,t.jsx)(r.p,{placeholder:"How much did you spent? (".concat((0,o.f)(),")"),className:"px-2",value:p,onChange:e=>w(e.target.value),onKeyDown:e=>e.key.match(/[^0-9]/g)&&"Backspace"!==e.key&&!e.key.startsWith("Arrow")&&("."!==e.key||e.target.value.includes("."))&&e.preventDefault()})]}),(0,t.jsx)("div",{className:"flex-1 flex items-start justify-center",children:(0,t.jsxs)(u.Zp,{className:"py-0 gap-0 overflow-hidden",children:[(0,t.jsx)(u.aR,{className:"text-center bg-background place-content-center gap-0 pt-4",children:(0,t.jsx)("span",{className:"text-muted-foreground",children:"When did you spent?"})}),(0,t.jsx)(x.V,{mode:"single",disabled:{after:new Date},endMonth:new Date,classNames:{day:"w-10 h-10"},selected:v||void 0,onSelect:e=>{s((0,f.kQ)(e||null))}})]})})]}),(0,t.jsxs)(l.Es,{className:"gap-4 border-t pt-4",children:[(0,t.jsx)(l.HM,{className:"text-sm px-4 h-8 rounded-md border cursor-pointer",children:"Cancel"}),(0,t.jsx)(n.$,{size:"sm",className:"w-16",onClick:b,children:"Update"})]})]})})}},67580:(e,a,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return s(753)}])}},e=>{var a=a=>e(e.s=a);e.O(0,[627,992,585,655,149,61,330,195,636,593,792],()=>a(67580)),_N_E=e.O()}]);